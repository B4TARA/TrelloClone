@model TrelloClone.ViewModels.UserBoardView


@foreach (var notification in Model.Notifications)
{


    <font color="red">
        <center>
            @notification
        </center>
    </font>


}


<section class="main_container_content">
    <div class="stages_main_wrapper">


        @foreach (var column in Model.Columns)
        {
            <div class="stage_wrapper" id="@column.Id">


                <div class="stage_header_info_wrapper margin_container_bottom_middle">
                    <div class="stage_info_main_wrapper margin_container_bottom_small">


                        <div class="stage_info_wrapper">
                            <div class="stage_indicator_circle default_bcolor"></div>
                            <div class="mid_title">
                                @column.Title
                            </div>
                            <!-- <textarea name="" id="" cols="0" rows="0" class="mid_title">Создано</textarea> -->
                        </div>


                        <div class="count_cards_wrapper">
                            <div class="mid_description">@column.Cards.Count()</div>
                        </div>


                    </div>
                    <div class="stage_indicator_line default_bcolor"></div>
                </div>


                @foreach (var card in column.Cards)
                {
                    <div class="cards_main_wrapper margin_container_bottom_middle">
                        <div class="card_wrapper open-popup">


                            <div class="card_header_wrapper margin_container_bottom_extrasmall">
                                <div class="card_name_wrapper">
                                    <div class="mid_description">
                                       @card.Term
                                    </div>
                                </div>
                            </div>


                            <div class="mid_title margin_container_bottom_extrasmall">
                                <a asp-controller="Card" asp-action="Details"
                                   asp-route-id="@card.Id" class="white-text">
                                    @card.Name
                                </a>
                            </div>


                            <div class="mid_description margin_container_bottom_small">
                               @card.Requirement
                            </div>


                            <div class="card_footer_wrapper">


                                @if (User.Claims.FirstOrDefault(c => c.Type == "ImagePath") != null)
                                {
                                    <div class="card_holders_wrapper">
                                        <div class="holder_image_wrapper">
                                            <img src="@User.Claims.FirstOrDefault(c => c.Type == "ImagePath").Value" alt="profileImg">
                                        </div>
                                    </div>
                                }

                                else
                                {
                                    <div class="card_holders_wrapper">
                                        <div class="holder_image_wrapper">
                                            <img src="/image/default_profile_icon.svg" alt="profileImg">
                                        </div>
                                    </div>
                                }


                                <div class="card_details_info_wrapper">
                                    <div class="card_detail_item">
                                        <div class="item_icon">
                                            <i class="fa-regular fa-message" style="color: #787486;"></i>
                                        </div>
                                        <div class="item_count">
                                            <div class="mid_description">
                                                4
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card_detail_item">
                                        <div class="item_icon">
                                            <i class="fa-solid fa-paperclip" style="color: #787486;"></i>
                                        </div>
                                        <div class="item_count">
                                            <div class="mid_description">
                                                10
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                }

               
                @if (Model.IsActiveToAddCard && column.Number == 1)
                {
                    <button class="action_btn white_btn add_card_btn">


                        <div class="action_btn_icon">
                            <i class="fa-solid fa-plus"></i>
                        </div>


                        <div class="description">
                                Добавить задачу
                        </div>
                       

                    </button>
                }


            </div>
        }

    </div>
</section>


@if (@Model.Columns.FirstOrDefault(x => x.Cards.Count() > 0) != null)
{
    <script>

        function accept() {
            $.ajax({
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                url: "/api/UserBoard/movecard",
                data: JSON.stringify({ userId: @Model.Id, columnId: @Model.Columns.FirstOrDefault(x => x.Cards.Count() > 0).Id }),
            })
        }

    </script>
}